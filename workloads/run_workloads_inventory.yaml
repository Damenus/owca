# This is a template inventory for run_workloads.yaml ansible playbook. 
# The file matches an imaginary setup of mesos cluster, which constists of:
# - four mesos-slave nodes,
#   - two on which applications will be run:    10.10.10.1  10.10.10.2,
#   - two on which load generators will be run: 10.10.10.11 10.10.10.12,
# - utility node with kafka and docker registry:10.10.10.99
# Let's assume also that docker registry contains needed 
# images tagged with `testing_setup`.

application_hosts:
  hosts:
    100.64.176.33:
      env_uniq_id: 1
      load_generator_host_ip: 100.64.176.34
#      workloads:
#        cassandra_ycsb: {'count': 0, 'resources': {'cpu', 0.1}}
#        cassandra_stress: {'count': 0}
#        redis_rpc_perf: {'count': 1}
#        twemcache_rpc_perf: {'count': 0}
#        twemcache_mutilate: {'count': 0}
#        specjbb: {'count': 0}
#        tensorflow_train: {'count': 0}
#        tensorflow_inference: {'count': 0}
#        tensorflow_benchmark_prediction: {'count': 0}
#        tensorflow_benchmark_train: {'count': 0}

#    10.10.10.2:
#      env_uniq_id: 2
#      load_generator_host_ip: 10.10.10.12
#      # Overwrite choosen keys.
#      workloads:
#        cassandra_ycsb: {'count': 1, 'resources': {'cpu', 0.1}}
#        cassandra_stress: {'count': 0}
#        redis_rpc_perf: {'count': 0}
#        twemcache_rpc_perf: {'count': 0}
#        twemcache_mutilate: {'count': 0}
#        specjbb: {'count': 1}
#        tensorflow_train: {'count': 0}
#        tensorflow_inference: {'count': 0}
#        tensorflow_benchmark_prediction: {'count': 0}
#        tensorflow_benchmark_train: {'count': 0}

  vars:
    # Variables for setting ansible.
    ansible_connection: local
    ansible_ssh_user: root
    ansible_user: root

    # Global variables to run workloads.
    cluster: example
    role: ddarczuk
    image_tag: 30ca7a36e3a4be0a121dd392c8289d5439af2c50
    orchestrator: Kubernetes

    wrapper_kafka_brokers: 100.64.176.12
    docker_registry: 100.64.176.12:80

    default_resources:
      cpu: 5
      ram: 5
      disk: 5

    # Per workload parameters.
    workloads:

      cassandra_ycsb:
        default:
          count: 0
          slo: 2500
          jmx_port: 7150
          storage_port: 7100
          communication_port: 9042
          cassandra:
            image_name: cassandra
            image_tag: 3.11.3
          ycsb:

      cassandra_stress:
        default:
          count: 0
          communication_port: 9142
          jmx_port: 7350
          storage_port: 7300
          slo: 1000
          cassandra:
            image_name: cassandra
            image_tag: 3.11.3
          cassandra_stress:

      redis_rpc_perf:
        default:
          labels:
              foo: bar
          count: 0
          slo: 100000
          communication_port: 6789
          redis:
            image_name: centos/redis
            image_tag: latest
          rpc_perf:

      twemcache_rpc_perf:
        default:
          count: 1
          slo: 100000
          communication_port: 11211
          twemcache:
            threads: 1
            max_memory: 1234
          rpc_perf:


      twemcache_mutilate:
        small:
          count: 0
          slo: 3200
          communication_port: 11311
          twemcache:
          mutilate:


      specjbb:
        default:
          count: 0
          slo: 26000000
          communication_port: 42000
          backend:
          injector:
          controller:

      tensorflow_inference:
        default:
          count: 0
          slo: 2 # in seconds (maximum time to process a single image)
          resources:
            cpu: 1
            ram: 2
            disk: 2

      tensorflow_train:
        default:
          count: 0
          slo: 0.5

      tensorflow_benchmark_train:
        default:
          count: 0
          slo: 0.03
          resources:
            cpu: 10
            ram: 50
            disk: 30

      tensorflow_benchmark_prediction:
        default:
          count: 0
          slo: 0.03
          resources:
            cpu: 10
            ram: 50
            disk: 30
