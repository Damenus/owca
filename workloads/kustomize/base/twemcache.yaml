apiVersion: apps/v1
kind: Deployment
metadata:
  name: twemcache
  labels:
    app: twemcache
spec:
  replicas: 1
  selector:
    matchLabels:
      app: twemcache
  template:
    metadata:
      labels:
        app: twemcache
    spec:
      nodeSelector:
        own_ip: 100.64.176.37
      containers:
      - name: twemcache
        image: 100.64.176.12:80/wca/twemcache:bc1b87e3894fd5deed1666e9d726202b1e38b7aa
        command: [ "/bin/sh" ]
        args:  ["-c", "$(COMMAND)" ]
        ports:
        - containerPort: 11211
        securityContext:
          runAsUser: 0
        env:
        - name: COMMAND
          valueFrom:
            configMapKeyRef:
              name: twemcache-command
              key: COMMAND
