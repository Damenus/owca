apiVersion: apps/v1
kind: Deployment
metadata:
  name: hammerdb
  labels:
    app: hammerdb
spec:
  replicas: 1
  selector:
    matchLabels:
      app: hammerdb
  template:
    metadata:
      labels:
        app: hammerdb
    spec:
      nodeSelector:
        own_ip: 100.64.176.37
      initContainers:
      - name:
      containers:
      - name: hammerdb
        image: 100.64.176.12:80/wca/hammerdb:4386405ee3e3db9b95231118510b9299460b2213
        command: [ "source" ]
        args:  ["workload.yaml" ]
        securityContext:
          runAsUser: 0
        vlo
      - name: mysql-tpm-gauge
        image: 100.64.176.12:80/wca/mysql-tpm-gauge:4386405ee3e3db9b95231118510b9299460b2213
        command: [ "/bin/sh" ]
        args:  ["-c", "$(COMMAND)" ]
        securityContext:
          runAsUser: 0
        env:
        - name: COMMAND
          valueFrom:
            configMapKeyRef:
              name: mysql-tpm-gauge-command
              key: COMMAND
